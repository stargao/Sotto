<div data-role="page" class="order-detail-page">
    <div data-role="header" data-tap-toggle="false" data-position="fixed" data-transition="slide">
        <a href="/" data-rel="back" data-icon="ion-chevron-left" data-iconpos="notext" data-ajax="false" class="ui-btn-left"></a>
        <h1 class="header-title">订单详情</h1>
        <a href="#" class="ui-btn-right top-right-btn">加 菜</a>
    </div>
    <div data-role="content">
        <ul data-role="listview" class="order-detail-list">
            <li class="order-info-line">
                <div class="ui-grid-solo">
                    <h4 class="desk-num">15<span>桌</span></h4>
                    <span class="order-time">2015-6-11 17:31</span>
                    <span class="order-status order-new">新订单</span>
                </div>
            </li>
            <li class="order-content-line">
                <div class="ui-grid-solo">
                    <p class="dishes-name">红烧肉</p>
                    <p class="dishes-num">1</p>
                    <div class="ctrl-wrap two-buttons">
                        <a href="#check" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all check-btn"></a>
                        <a href="#edit" class="ui-btn ui-icon-ion-compose ui-btn-icon-notext ui-shadow ui-corner-all edit-btn"></a>    
                    </div>
                    <div class="ctrl-wrap change-number">
                        <a href="#save" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-d save-btn"></a>
                        <a href="#plus" class="ui-btn ui-icon-ion-plus ui-btn-icon-notext ui-shadow ui-corner-all plus-btn"></a>
                        <p class="change-dishes-num">1</p>
                        <a href="#minus" class="ui-btn ui-icon-ion-minus ui-btn-icon-notext ui-shadow ui-corner-all minus-btn"></a>    
                    </div>
                    <div class="ctrl-wrap del-item">
                        <a href="#del" class="ui-btn ui-icon-ion-trash-a ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-f del-btn"></a>
                        <p class="del-msg">删除?</p>
                        <a href="#cancel" class="ui-btn ui-icon-ion-close ui-btn-icon-notext ui-shadow ui-corner-all cancel-btn"></a>    
                    </div>
                    <span class="finished-status">已送</span>
                </div>
            </li>
            <li class="order-content-line">
                <div class="ui-grid-solo">
                    <p class="dishes-name">干煸肥肠</p>
                    <p class="dishes-num">1</p>
                    <div class="ctrl-wrap two-buttons">
                        <a href="#check" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all check-btn"></a>
                        <a href="#edit" class="ui-btn ui-icon-ion-compose ui-btn-icon-notext ui-shadow ui-corner-all edit-btn"></a>    
                    </div>
                    <div class="ctrl-wrap change-number">
                        <a href="#save" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-d save-btn"></a>
                        <a href="#plus" class="ui-btn ui-icon-ion-plus ui-btn-icon-notext ui-shadow ui-corner-all plus-btn"></a>
                        <p class="change-dishes-num">1</p>
                        <a href="#minus" class="ui-btn ui-icon-ion-minus ui-btn-icon-notext ui-shadow ui-corner-all minus-btn"></a>    
                    </div>
                    <div class="ctrl-wrap del-item">
                        <a href="#del" class="ui-btn ui-icon-ion-trash-a ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-f del-btn"></a>
                        <p class="del-msg">删除?</p>
                        <a href="#cancel" class="ui-btn ui-icon-ion-close ui-btn-icon-notext ui-shadow ui-corner-all cancel-btn"></a>    
                    </div>
                    <span class="finished-status">已送</span>
                </div>
            </li>
            <li class="order-content-line">
                <div class="ui-grid-solo">
                    <p class="dishes-name">青椒土豆</p>
                    <p class="dishes-num">1</p>
                    <div class="ctrl-wrap two-buttons">
                        <a href="#check" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all check-btn"></a>
                        <a href="#edit" class="ui-btn ui-icon-ion-compose ui-btn-icon-notext ui-shadow ui-corner-all edit-btn"></a>    
                    </div>
                    <div class="ctrl-wrap change-number">
                        <a href="#save" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-d save-btn"></a>
                        <a href="#plus" class="ui-btn ui-icon-ion-plus ui-btn-icon-notext ui-shadow ui-corner-all plus-btn"></a>
                        <p class="change-dishes-num">1</p>
                        <a href="#minus" class="ui-btn ui-icon-ion-minus ui-btn-icon-notext ui-shadow ui-corner-all minus-btn"></a>    
                    </div>
                    <div class="ctrl-wrap del-item">
                        <a href="#del" class="ui-btn ui-icon-ion-trash-a ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-f del-btn"></a>
                        <p class="del-msg">删除?</p>
                        <a href="#cancel" class="ui-btn ui-icon-ion-close ui-btn-icon-notext ui-shadow ui-corner-all cancel-btn"></a>    
                    </div>
                    <span class="finished-status">已送</span>
                </div>
            </li>
            <li class="order-content-line finished-line">
                <div class="ui-grid-solo">
                    <p class="dishes-name">紫菜蛋花汤</p>
                    <p class="dishes-num">1</p>
                    <div class="ctrl-wrap two-buttons">
                        <a href="#check" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all check-btn"></a>
                        <a href="#edit" class="ui-btn ui-icon-ion-compose ui-btn-icon-notext ui-shadow ui-corner-all edit-btn"></a>    
                    </div>
                    <div class="ctrl-wrap change-number">
                        <a href="#save" class="ui-btn ui-icon-ion-checkmark ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-d save-btn"></a>
                        <a href="#plus" class="ui-btn ui-icon-ion-plus ui-btn-icon-notext ui-shadow ui-corner-all plus-btn"></a>
                        <p class="change-dishes-num">1</p>
                        <a href="#minus" class="ui-btn ui-icon-ion-minus ui-btn-icon-notext ui-shadow ui-corner-all minus-btn"></a>    
                    </div>
                    <div class="ctrl-wrap del-item">
                        <a href="#del" class="ui-btn ui-icon-ion-trash-a ui-btn-icon-notext ui-shadow ui-corner-all ui-btn-f del-btn"></a>
                        <p class="del-msg">删除?</p>
                        <a href="#cancel" class="ui-btn ui-icon-ion-close ui-btn-icon-notext ui-shadow ui-corner-all cancel-btn"></a>    
                    </div>
                    <span class="finished-status">已送</span>
                </div>
            </li>
        </ul>

        <ul data-role="listview" class="order-detail-list special-item-list">
            <li class="order-info-line">
                <div class="ui-grid-solo">
                    <span class="order-title">固定消费项目</span>
                </div>
            </li>
            <li class="order-content-line">
                <div class="ui-grid-solo">
                    <p class="dishes-name">碗筷</p>
                    <div class="ctrl-wrap change-number">
                        <a href="#plus-only" class="ui-btn ui-icon-ion-plus ui-btn-icon-notext ui-shadow ui-corner-all plus-btn"></a>
                        <p class="change-dishes-num">1</p>
                        <a href="#minus-only" class="ui-btn ui-icon-ion-minus ui-btn-icon-notext ui-shadow ui-corner-all minus-btn"></a>    
                    </div>
                </div>
            </li>
        </ul>
    </div>

    <div class="ui-grid-solo bottom-line">
        <a href="#pay" class="ui-btn ui-btn-f ui-btn-block ui-icon-ion-card ui-btn-icon-left">待付款: <span>382.0 元</span></a>
    </div>
    <script>
        $(function(){
            $('.order-detail-list li.order-content-line .two-buttons a').click(function(){
                var clickBtn = $(this).attr('href');

                if(clickBtn == '#check') {
                    $(this).closest('.order-content-line').find('.two-buttons').hide();
                    $(this).closest('.order-content-line').addClass('finished-line');
                } else if(clickBtn == '#edit') {
                    $(this).closest('.order-content-line').find('.two-buttons').hide();
                    $(this).closest('.order-content-line').find('.dishes-num').hide();
                    $(this).closest('.order-content-line').find('.change-number').fadeIn('fast');
                    var thisDishNum = $(this).closest('.order-content-line').find('.dishes-num').text();
                    $(this).closest('.order-content-line').find('.change-dishes-num').text(thisDishNum);
                }
            });

            $('.order-detail-list li.order-content-line .change-number a').click(function(){
                var clickBtn = $(this).attr('href');
                var dishNum = parseInt($(this).closest('.change-number').find('.change-dishes-num').text());
                
                if(clickBtn == '#plus'){
                    dishNum = dishNum + 1;
                    $(this).closest('.change-number').find('.change-dishes-num').text(dishNum);
                } else if(clickBtn == '#minus') {
                    if(dishNum == 1) {
                        $(this).closest('.order-content-line').find('.change-number').hide();
                        $(this).closest('.order-content-line').find('.del-item').fadeIn('fast');
                    } else {
                        dishNum = dishNum - 1;
                        $(this).closest('.change-number').find('.change-dishes-num').text(dishNum);
                    }
                } else if(clickBtn == '#save') {
                    $(this).closest('.order-content-line').find('.two-buttons').fadeIn('fast');
                    $(this).closest('.order-content-line').find('.dishes-num').text(dishNum);
                    $(this).closest('.order-content-line').find('.dishes-num').show();
                    $(this).closest('.change-number').hide();
                }
            });

            $('.order-detail-list li.order-content-line .del-item a').click(function(){
                var clickBtn = $(this).attr('href');

                if(clickBtn == '#del') {
                    $(this).closest('.order-content-line').remove();
                } else if(clickBtn == '#cancel') {
                    $(this).closest('.order-content-line').find('.change-number').fadeIn('fast');
                    $(this).closest('.order-content-line').find('.del-item').hide();
                }
            });

            $('.special-item-list li.order-content-line .change-number a').click(function(){
                var clickBtn = $(this).attr('href');
                var dishNum = parseInt($(this).closest('.change-number').find('.change-dishes-num').text());
                
                if(clickBtn == '#plus-only'){
                    dishNum = dishNum + 1;
                    $(this).closest('.change-number').find('.change-dishes-num').text(dishNum);
                } else if(clickBtn == '#minus-only') {
                    if(dishNum == 1) {
                        return;
                    } else {
                        dishNum = dishNum - 1;
                        $(this).closest('.change-number').find('.change-dishes-num').text(dishNum);
                    }
                }
            });
        });
    </script>
</div>
